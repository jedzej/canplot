import{j as E}from"./jsx-runtime-D_zvdyIk.js";import{r as f}from"./iframe-Csdz-dE8.js";const $=5,Z=10,H=60,te=30,B="UTC",ne="en-GB",R=(e,t,s)=>Math.min(Math.max(e,t),s),se=(e,t,s,i)=>{const{min:o,max:n}=k(e,s),a=e.chartAreaCanvasPX,l=(S(e,s)?a.width:a.height)/(n-o);return t/l},k=(e,t)=>{const s=e.scales.find(i=>i.id===t);if(!s)throw new Error(`Scale ${t} not found`);return s},S=(e,t)=>e.scales.find(s=>s.id===t)?.origin==="x",q=(e,t)=>{const s=window.devicePixelRatio||1;e.lineCap=t?.lineCap??"butt",e.lineDashOffset=s*(t?.lineDashOffset??0),e.lineJoin=t?.lineJoin??"miter",e.lineWidth=s*(t?.lineWidth??1),e.miterLimit=s*(t?.miterLimit??10),e.strokeStyle=t?.strokeStyle??"black",e.fillStyle=t?.fillStyle??e.strokeStyle,e.font=t?.font??`${10*s}px sans-serif`,e.textAlign=t?.textAlign??"start",e.direction=t?.direction??"inherit",e.textBaseline=t?.textBaseline??"alphabetic",e.fontKerning=t?.fontKerning??"auto"},G=(e,t,s,i)=>{const o=i==="canvas"?e.chartAreaCanvasPX:e.chartAreaCSS,{min:n,max:a}=k(e,s),l=(S(e,s)?o.width:o.height)/(a-n);return t*l},C=(e,t,s,i)=>{const{min:o}=k(e,s),n=i==="canvas"?e.chartAreaCanvasPX:e.chartAreaCSS,a=G(e,t-o,s,i);return S(e,s)?R(n.x+a,n.x-10*n.width,n.x+11*n.width):R(n.y+n.height-a,n.y-10*n.height,n.y+11*n.height)},ie=(e,t,s)=>{const i=s==="canvas"?e.chartAreaCanvasPX:e.chartAreaCSS;return R(t,i.x,i.x+i.width)},oe=(e,t,s)=>{const i=s==="canvas"?e.chartAreaCanvasPX:e.chartAreaCSS;return R(t,i.y,i.y+i.height)},ae=(e,t,s)=>{const{min:i,max:o}=k(e,s);return t>=i&&t<=o},qe=(e,t,s,i)=>{const{min:o,max:n}=k(e,s),a=e.chartAreaCSS,l=S(e,s)?(t-a.x)/a.width:(a.height-t+a.y)/a.height;return o+l*(n-o)},re=1,K=1e3*re,j=60*K,z=60*j,D=24*z,ce=30*D,le=365*D,ue=[[1,"milliseconds"],[2,"milliseconds"],[5,"milliseconds"],[10,"milliseconds"],[20,"milliseconds"],[50,"milliseconds"],[100,"milliseconds"],[200,"milliseconds"],[500,"milliseconds"],[1,"seconds"],[5,"seconds"],[10,"seconds"],[15,"seconds"],[30,"seconds"],[1,"minutes"],[5,"minutes"],[10,"minutes"],[15,"minutes"],[30,"minutes"],[1,"hours"],[2,"hours"],[3,"hours"],[4,"hours"],[6,"hours"],[8,"hours"],[12,"hours"],[1,"days"],[3,"days"],[5,"days"],[7,"days"],[10,"days"],[15,"days"],[1,"months"],[2,"months"],[3,"months"],[4,"months"],[6,"months"],[1,"years"],[2,"years"],[5,"years"],[10,"years"],[25,"years"],[50,"years"],[100,"years"]],A=e=>{const[t,s]=e;switch(s){case"milliseconds":return t;case"seconds":return t*K;case"minutes":return t*j;case"hours":return t*z;case"days":return t*D;case"months":return t*ce;case"years":return t*le}},he=(e,t)=>{const s=new Date(e);return s.setUTCMilliseconds(s.getUTCMilliseconds()+t),s.getTime()},de=(e,t)=>{const s=new Date(e);return s.setUTCSeconds(s.getUTCSeconds()+t),s.getTime()},me=(e,t)=>{const s=new Date(e);return s.setUTCMinutes(s.getUTCMinutes()+t),s.getTime()},pe=(e,t)=>{const s=new Date(e);return s.setUTCHours(s.getUTCHours()+t),s.getTime()},ge=(e,t)=>{const s=new Date(e);return s.setUTCDate(s.getUTCDate()+t),s.getTime()},N=(e,t)=>{const s=new Date(e);return s.setUTCMonth(s.getUTCMonth()+t),s.getTime()},v=(e,t)=>{const[s,i]=t;switch(i){case"milliseconds":return he(e,s);case"seconds":return de(e,s);case"minutes":return me(e,s);case"hours":return pe(e,s);case"days":return ge(e,s);case"months":return N(e,s);case"years":return N(e,s*12)}};function U(e,t){const s=new Date(e),i=new Date(s.toLocaleString("en-US",{timeZone:t})),o=new Date(s.toLocaleString("en-US",{timeZone:"UTC"}));return(i.getTime()-o.getTime())/(3600*1e3)}const fe=(e,t,s="UTC")=>{const[i,o]=t;let n=new Date(e);const a=()=>{n.setUTCHours(-U(n,s),0,0,0)};switch(o){case"milliseconds":n.setUTCMilliseconds(Math.ceil(n.getUTCMilliseconds()/i)*i);break;case"seconds":n.setUTCSeconds(Math.ceil(n.getUTCSeconds()/i)*i,0);break;case"minutes":n.setUTCMinutes(Math.ceil(n.getTime()%z/j/i)*i,0,0);break;case"hours":n.setUTCHours(Math.ceil(n.getTime()%D/z/i)*i,0,0,0);break;case"days":case"months":case"years":o==="months"?n.setUTCDate(1):o==="years"&&n.setUTCMonth(0,1),a(),n.getTime()<e&&(n=new Date(v(n,[1,o])));break}return n.getTime()},xe=({timeZone:e=B,space:t=H})=>({frame:s,scaleId:i})=>{const{min:o,max:n}=k(s,i),a=Math.floor(s.chartAreaCanvasPX.width/t)+1,m=(n-o)/a,[u,h]=ue.find(p=>A(p)>=m)??[1,"milliseconds"],g=fe(o,[u,h],e),d=U(g,e),r=[g];let c;for(;;){switch(h){case"milliseconds":case"seconds":case"minutes":case"hours":{c=v(g,[r.length*u,h]);break}case"days":{const p=v(g,[r.length*u,h]);c=v(p,[d-U(p,e),"hours"]);break}case"months":case"years":{const p=v(v(v(g,[d,"hours"]),[r.length*u,h]),[-d,"hours"]);c=v(p,[d-U(p,e),"hours"]);break}}if(c>n)break;r.push(c)}return r},T=(e,t,s)=>e.find(i=>i.type===s)?.value!==t.find(i=>i.type===s)?.value,ye=({timeZone:e=B,locale:t=ne,showTimezone:s=!0})=>{const i=new Intl.DateTimeFormat(t,{year:"numeric",day:"numeric",month:"short",hour:"numeric",hourCycle:"h23",minute:"numeric",second:"numeric",fractionalSecondDigits:3,timeZoneName:"short",timeZone:e});return({ticks:o})=>{const n=o[1]-o[0],a=n<A([1,"days"]),l=n<A([1,"minutes"]),m=n<A([1,"seconds"]);return o.map(u=>i.formatToParts(new Date(u))).map((u,h,g)=>{const d=g[h-1],r=h===0||T(u,d,"year"),c=h===0||T(u,d,"day"),p=h===0||T(u,d,"month"),w=h===0||T(u,d,"hour"),x=h===0||T(u,d,"timeZoneName"),Y=h===0||T(u,d,"minute"),W=h===0||T(u,d,"second"),J=h===0||T(u,d,"fractionalSecond"),P=[];if(a&&(w||Y||x||W||J)){const y=u.find(b=>b.type==="hour")?.value,I=u.find(b=>b.type==="minute")?.value,Q=u.find(b=>b.type==="timeZoneName")?.value;let F="";if(l){const b=u.find(L=>L.type==="second")?.value,ee=u.find(L=>L.type==="fractionalSecond")?.value;F=`:${b}`+(m?`.${ee}`:"")}P.push(`${y}:${I}${F}`+(s&&x?` ${Q}`:""))}return(c||p)&&P.push([u.find(y=>y.type==="month")?.value,c&&u.find(y=>y.type==="day")?.value].filter(Boolean).join(" ")),r&&P.push(u.find(y=>y.type==="year")?.value),P.filter(y=>y).join(`
`)})}},M=[];for(let e=-12;e<=12;e++)M.push(1*10**e),M.push(2*10**e),M.push(5*10**e);const Te=e=>{const{ctx:t,scales:s}=e;t.save(),t.strokeStyle="black",t.fillStyle="black",t.lineWidth=1,t.font="12px Arial",t.textAlign="center",t.textBaseline="middle";for(const i of s){if(!i.axis)continue;const o=i.type==="time"?xe({space:i.axis.tickSpace,timeZone:i.timeZone}):ve({space:i.axis.tickSpace}),n=i.type==="time"?ye({timeZone:i.timeZone,showTimezone:i.axis.showTimezone,locale:i.locale}):we,a=i.axis.canvasRect;if(i.origin==="x"){if(i.axis.position==="bottom")t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(a.x+a.width,a.y),t.stroke(),X(e,i.id,a.y,o,n);else if(i.axis.position==="top"){const l=a.y+a.height;t.beginPath(),t.moveTo(a.x,l),t.lineTo(a.x+a.width,l),t.stroke(),X(e,i.id,l,o,n)}}else if(i.axis.position==="left"){const l=a.x+a.width;t.beginPath(),t.moveTo(l,a.y),t.lineTo(l,a.y+a.height),t.stroke(),O(e,i.id,l,o,n)}else i.axis.position==="right"&&(t.beginPath(),t.moveTo(a.x,a.y),t.lineTo(a.x,a.y+a.height),t.stroke(),O(e,i.id,a.x,o,n))}t.restore()},O=(e,t,s,i,o)=>{const{ctx:n}=e,a=e.scales.find(c=>c.id===t)?.axis;if(!a)return;const l=window.devicePixelRatio||1,m=$,u=s,h=a.position==="left"?s-m:s+m,g=Z*l,d=i({frame:e,scaleId:t})??[],r=o({frame:e,scaleId:t,ticks:d});n.save(),n.fontKerning="auto",q(n,{}),n.beginPath();for(let c=0;c<d.length;c++){const p=C(e,d[c],t,"canvas");n.moveTo(u,p),n.lineTo(h,p)}n.stroke(),n.restore(),n.save(),q(n,{textBaseline:"middle",textAlign:a.position==="left"?"right":"left"});for(let c=0;c<d.length;c++){const p=C(e,d[c],t,"canvas"),w=r[c].split(`
`);for(let x=0;x<w.length;x++)n.fillText(` ${w[x]} `,h,p+x*g)}n.restore()},X=(e,t,s,i,o)=>{const{ctx:n}=e,a=e.scales.find(c=>c.id===t)?.axis;if(!a)return;const l=window.devicePixelRatio||1,m=$,u=s,h=a.position==="top"?s-m:s+m,g=Z*l,d=i({frame:e,scaleId:t})??[],r=o({frame:e,scaleId:t,ticks:d});n.save(),n.fontKerning="auto",q(n,{}),n.beginPath();for(let c=0;c<d.length;c++){const p=C(e,d[c],t,"canvas");n.moveTo(p,u),n.lineTo(p,h)}n.stroke(),n.restore(),n.save(),q(n,{textBaseline:a.position==="top"?"bottom":"top",textAlign:"center"});for(let c=0;c<d.length;c++){const p=C(e,d[c],t,"canvas"),w=r[c].split(`
`);for(let x=0;x<w.length;x++)n.fillText(w[x],p,h+l*2+x*g)}n.restore()},ve=({space:e}={})=>({frame:t,scaleId:s})=>{const{min:i,max:o}=k(t,s),n=[],a=window.devicePixelRatio||1,l=(e??(S(t,s)?H:te))*a,m=se(t,l,s),u=M.find(g=>g>m)??1;let h=i%u<Number.EPSILON?i:i+u-i%u;for(;h<=o;)n.push(h),h+=u;return n},we=({ticks:e})=>{const t=Math.max(0,Math.ceil(-Math.log10(e[1]-e[0])));return e.map(s=>s.toFixed(t))},V=f.createContext(null),ze=e=>{const t=f.useContext(V);if(!t)throw new Error("useFrame must be used within a CanPlot component");const s=f.useRef(e);return s.current=e,f.useLayoutEffect(()=>{const i=s.current;i&&Promise.resolve().then(()=>{i({frame:t,clampXPosToChartArea:(o,n)=>ie(t,o,n??"canvas"),clampYPosToChartArea:(o,n)=>oe(t,o,n??"canvas"),valToPos:(o,n,a)=>C(t,o,n,a??"canvas"),valToPxDistance:(o,n,a)=>G(t,o,n,a??"canvas"),valFits:(o,n)=>ae(t,o,n)})})},[t]),t};function be(e){return t=>{for(const s of e)_(s,t)}}function ke(e){return t=>{const s=[];for(const i of e){const o=_(i,t),n=typeof o=="function";s.push(n?o:()=>_(i,null))}return()=>{for(const i of s)i()}}}function _(e,t){if(typeof e=="function")return e(t);e&&(e.current=t)}var Ce=parseInt(f.version.split(".")[0],10)>=19?ke:be;const Se=f.forwardRef(({configuration:e,children:t,style:s,className:i},o)=>{const n=f.useRef(null),a=f.useRef(null),l=Pe(a),[m,u]=f.useState(null);f.useLayoutEffect(()=>{u(Ae(e,l,n.current))},[e,l]),f.useLayoutEffect(()=>{m&&Ue(m)},[m]);const h=window.devicePixelRatio||1;return E.jsxs("div",{ref:Ce([o,a]),className:i,style:{position:"relative",overflow:"hidden",...s},"data-canplotroot":!0,children:[E.jsx("canvas",{ref:n,width:l.width*h,height:l.height*h,style:{inset:0,position:"absolute",width:`${l.width}px`,height:`${l.height}px`}}),m&&E.jsx(V.Provider,{value:m,children:t})]})}),Pe=e=>{const[t,s]=f.useState({width:0,height:0}),[i]=f.useState(()=>new ResizeObserver(o=>{for(const n of o){const a=Math.round(n.contentRect.width),l=Math.round(n.contentRect.height);s(m=>m.width!==a||m.height!==l?{...m,width:a,height:l}:m)}}));return f.useLayoutEffect(()=>{if(!e.current)return;const o=e.current.clientWidth,n=e.current.clientHeight;return s(a=>a.width!==o||a.height!==n?{...a,width:o,height:n}:a),i.observe(e.current,{box:"border-box"}),()=>i.disconnect()},[i,e]),t},Ae=(e,t,s)=>{const i=s?.getContext("2d");if(!i)return null;const o=window.devicePixelRatio||1;if(t.width===0||t.height===0)return null;const n={x:e.padding.left,y:e.padding.top,width:t.width-e.padding.left-e.padding.right,height:t.height-e.padding.top-e.padding.bottom};for(const r of e.scales)r.axis&&(r.origin==="x"?(r.axis.position==="bottom"||r.axis.position==="top")&&(n.height=Math.max(0,n.height-r.axis.size),r.axis.position==="top"&&(n.y+=r.axis.size)):(r.axis.position==="left"||r.axis.position==="right")&&(n.width=Math.max(0,n.width-r.axis.size),r.axis.position==="left"&&(n.x+=r.axis.size)));const a={x:n.x*o,y:n.y*o,width:n.width*o,height:n.height*o},l=[];let m=e.padding.left*o,u=i.canvas.width-e.padding.right*o,h=i.canvas.height-e.padding.bottom*o,g=e.padding.top*o;for(const r of e.scales){if(!r.axis){l.push({...r,axis:null});continue}let c;if(r.origin==="x")switch(r.axis.position){case"bottom":h-=r.axis.size*o,c={x:n.x,y:h/o,width:n.width,height:r.axis.size};break;case"top":g+=r.axis.size*o,c={x:n.x,y:g/o-r.axis.size,width:n.width,height:r.axis.size};break;case"left":case"right":throw new Error("Invalid axis position for x origin")}else switch(r.axis.position){case"left":m+=r.axis.size*o,c={x:m/o-r.axis.size,y:n.y,width:r.axis.size,height:n.height};break;case"right":u-=r.axis.size*o,c={x:u/o,y:n.y,width:r.axis.size,height:n.height};break;case"top":case"bottom":throw new Error("Invalid axis position for y origin")}const p={x:c.x*o,y:c.y*o,width:c.width*o,height:c.height*o};l.push({...r,axis:{...r.axis,cssRect:c,canvasRect:p}})}return{ctx:i,dpr:o,padding:e.padding,scales:l,chartAreaCSS:n,chartAreaCanvasPX:a}},Ue=e=>{e.ctx.clearRect(0,0,e.ctx.canvas.width,e.ctx.canvas.height),Te(e)};Se.__docgenInfo={description:"",methods:[],displayName:"CanPlot",props:{configuration:{required:!0,tsType:{name:"signature",type:"object",raw:`{
  padding: PlotPadding;
  scales: PlotScaleConfig[];
}`,signature:{properties:[{key:"padding",value:{name:"signature",type:"object",raw:`{
  top: number;
  bottom: number;
  left: number;
  right: number;
}`,signature:{properties:[{key:"top",value:{name:"number",required:!0}},{key:"bottom",value:{name:"number",required:!0}},{key:"left",value:{name:"number",required:!0}},{key:"right",value:{name:"number",required:!0}}]},required:!0}},{key:"scales",value:{name:"Array",elements:[{name:"union",raw:"PlotScaleLinearConfig | PlotScaleTimeConfig",elements:[{name:"signature",type:"object",raw:`{
  type: "linear";
  id: string;
  min: number;
  max: number;
  origin: "x" | "y";
  axis: null | PlotAxisLinear;
}`,signature:{properties:[{key:"type",value:{name:"literal",value:'"linear"',required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"min",value:{name:"number",required:!0}},{key:"max",value:{name:"number",required:!0}},{key:"origin",value:{name:"union",raw:'"x" | "y"',elements:[{name:"literal",value:'"x"'},{name:"literal",value:'"y"'}],required:!0}},{key:"axis",value:{name:"union",raw:"null | PlotAxisLinear",elements:[{name:"null"},{name:"signature",type:"object",raw:`{
  position: "left" | "right" | "top" | "bottom";
  size: number;
  tickSpace?: number;
}`,signature:{properties:[{key:"position",value:{name:"union",raw:'"left" | "right" | "top" | "bottom"',elements:[{name:"literal",value:'"left"'},{name:"literal",value:'"right"'},{name:"literal",value:'"top"'},{name:"literal",value:'"bottom"'}],required:!0}},{key:"size",value:{name:"number",required:!0}},{key:"tickSpace",value:{name:"number",required:!1}}]}}],required:!0}}]}},{name:"signature",type:"object",raw:`{
  type: "time";
  id: string;
  min: number;
  max: number;
  origin: "x" | "y";
  axis: null | PlotAxisTime;
  timeZone: string;
  locale?: string;
}`,signature:{properties:[{key:"type",value:{name:"literal",value:'"time"',required:!0}},{key:"id",value:{name:"string",required:!0}},{key:"min",value:{name:"number",required:!0}},{key:"max",value:{name:"number",required:!0}},{key:"origin",value:{name:"union",raw:'"x" | "y"',elements:[{name:"literal",value:'"x"'},{name:"literal",value:'"y"'}],required:!0}},{key:"axis",value:{name:"union",raw:"null | PlotAxisTime",elements:[{name:"null"},{name:"signature",type:"object",raw:`{
  position: "left" | "right" | "top" | "bottom";
  size: number;
  tickSpace?: number;
  showTimezone?: boolean;
}`,signature:{properties:[{key:"position",value:{name:"union",raw:'"left" | "right" | "top" | "bottom"',elements:[{name:"literal",value:'"left"'},{name:"literal",value:'"right"'},{name:"literal",value:'"top"'},{name:"literal",value:'"bottom"'}],required:!0}},{key:"size",value:{name:"number",required:!0}},{key:"tickSpace",value:{name:"number",required:!1}},{key:"showTimezone",value:{name:"boolean",required:!1}}]}}],required:!0}},{key:"timeZone",value:{name:"string",required:!0}},{key:"locale",value:{name:"string",required:!1}}]}}]}],raw:"PlotScaleConfig[]",required:!0}}]}},description:""},children:{required:!1,tsType:{name:"ReactNode"},description:""},style:{required:!1,tsType:{name:"ReactCSSProperties",raw:"React.CSSProperties"},description:""},className:{required:!1,tsType:{name:"string"},description:""}}};export{Se as C,oe as a,q as b,ie as c,C as d,qe as e,k as g,ae as p,ze as u,G as v};
